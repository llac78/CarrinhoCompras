<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org" >

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	<title>My Cart</title>
	
	<script>
		$('#myModal').on('shown.bs.modal', function () {
		  $('#myInput').trigger('focus')
		})
	</script>
</head>
<body>
	<h1>MY CART</h1>
	<h5>Cadastrar Novo Produto</h5>
	
	<form id="id_form_cadastroProduto" action="#" th:action="@{/inserirProduto}" th:object="${produto}" method="post">
		<table>
			<tbody>
				<tr>
					<td>
						<label>Descrição</label>
					</td>
					<td>
						<input type="text" th:field="*{descricao}" />
					</td>
					<td>
						<span th:if="${#fields.hasErrors('descricao')}" th:errors="*{descricao}" style="color:red;" />
					</td>
				</tr>
				<tr>
					<td>
						<label>Preço(R$)</label>
					</td>
					<td>
						<input type="number" th:field="*{preco}" min="0" step="0.01" pattern="^\d+(?:\.\d{1,2})?$" />
					</td>
					<td>
						<span th:if="${#fields.hasErrors('preco')}" th:errors="*{preco}" style="color:red;" />
					</td>
				</tr>
				<tr>
					<td></td>
					<td align="right">
						<button type="submit" class="btn btn-primary">Salvar</button>
					</td>
				</tr>
		
			</tbody>
		</table>
	</form>
	
	<br />
	<br />
	
	<div th:if="${produtos.empty}">
		<p> Não há produtos cadastrados.</p>
	</div>

	<table class="table">
		<thead class="thead-primary">
			<th scope="col">ID</th>
			<th scope="col">DESCRIÇÃO</th>
			<th scope="col">PREÇO (R$)</th>
			<th scope="col">#</th>
		</thead>
		<tbody th:each="produto : ${produtos}">
			<tr>
	            <td><span th:text="${produto.id}"></span></td>
	            <td><span th:text="${produto.descricao}"></span></td>
	            <td><span th:text="${produto.preco}"></span></td>
	            <td>
					<input type="button" class="btn btn-danger btn-sm" value="Excluir" data-toggle="modal" data-target="#modalwarning" th:attr="data-target='#modalwarning'+${produto.id}" />
				</td>
	        </tr>
	        
	        <!-- MODAL DELETE -->
	        <div id="modalwarning" class="modal" tabindex="-1" role="dialog" th:id="modalwarning+${produto.id}">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title">
						<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-exclamation-triangle-fill" fill="red" xmlns="http://www.w3.org/2000/svg">
						  <path fill-rule="evenodd" d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zm-6.106 4.5a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
						</svg>
						Atenção
					</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
			      </div>
			      <div class="modal-body">
			        <p>Deseja excluir este registro?</p>
			      </div>
			      <div class="modal-footer">
	            	<form id="id_form_deletarProduto" th:action="@{/{id}/deletarProduto(id=${produto.id})}" method="post">
	           			<input type="submit" value="Sim" class="btn btn-primary" />
	            	</form>
			        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
			      </div>
			    </div>
			  </div>
			</div>
	        
		</tbody>
	</table>
	
	<div id="modalwarning" class="modal" tabindex="-1" role="dialog" th:id="modalwarning+${produto.id}">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title">
				<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-exclamation-triangle-fill" fill="red" xmlns="http://www.w3.org/2000/svg">
				  <path fill-rule="evenodd" d="M11.46.146A.5.5 0 0 0 11.107 0H4.893a.5.5 0 0 0-.353.146L.146 4.54A.5.5 0 0 0 0 4.893v6.214a.5.5 0 0 0 .146.353l4.394 4.394a.5.5 0 0 0 .353.146h6.214a.5.5 0 0 0 .353-.146l4.394-4.394a.5.5 0 0 0 .146-.353V4.893a.5.5 0 0 0-.146-.353L11.46.146zm-6.106 4.5a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
				</svg>
				Atenção
			</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <p>Deseja excluir este registro?</p>
	      </div>
	      <div class="modal-footer">
	      
	      	<a type="button" class="btn btn-outline" th:href="@{/{id}/deletarProduto(id=${produto.id})}"><i class="fa fa-check"></i>&nbsp;Yes</a>
	      
<!-- 	        <button type="button" class="btn btn-primary">Sim</button> -->
	        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
	      </div>
	    </div>
	  </div>
	</div>
	
	
	<!-- jQuery, Poper, Boostrap -->
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
</body>
</html>